---
- name: set up new vm
  vsphere_guest:
    vcenter_hostname: vcenter.void.lab
    username: ccasares@void.lab
    password: {{ vcenter_password }}
    guest: {{ new_vm_name }}
    state: powered_on
    vm_extra_config:
      vcpu.hotadd: yes
      mem.hotadd:  yes
    vm_disk:
      disk1:
        size_gb: 20
        type: thin
        datastore: VMSTORE
    vm_nic:
      nic1:
        type: vmxnet3
        network: VM Network
        network_type: standard
    vm_hardware:
      memory_mb: 1024
      num_cpus: 2
      osid: centos64Guest
      scsi: paravirtual
    esxi:
      datacenter: VoidLab
      hostname: eridanus.void.lab
  delegate_to: localhost